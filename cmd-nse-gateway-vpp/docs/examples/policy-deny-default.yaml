# IP网关策略配置示例 - 默认拒绝策略（推荐）
#
# 使用场景：
# - 安全性要求较高
# - 只允许已知的可信IP访问
# - 采用"白名单"模式
#
# 应用此配置：
#   export NSM_IP_POLICY_CONFIG_PATH=/path/to/policy-deny-default.yaml
#   或在Kubernetes中通过ConfigMap挂载

# 允许列表（白名单）
# 只有这些IP地址或CIDR网段被允许访问
allowList:
  - "192.168.1.0/24"      # 公司内网
  - "10.0.0.0/24"         # 开发环境网段
  - "172.16.0.100"        # 特定的可信服务器
  - "203.0.113.0/24"      # 合作伙伴网段

# 禁止列表（黑名单）
# 即使在白名单网段内，这些IP也被禁止访问
# 注意：黑名单优先级高于白名单
denyList:
  - "192.168.1.50"        # 被入侵的内网主机
  - "10.0.0.5"            # 测试机器（生产环境禁止访问）

# 默认动作
# 当IP不在任何列表中时的处理方式
# 推荐使用"deny"以提高安全性
defaultAction: "deny"

# 说明：
# 1. 如果源IP在denyList中 → 立即阻止（优先级最高）
# 2. 如果源IP在allowList中 → 允许放行
# 3. 如果都不匹配 → 应用defaultAction（此处为拒绝）
#
# 示例匹配结果：
#   - 192.168.1.100  → 允许（在allowList网段中）
#   - 192.168.1.50   → 阻止（在denyList中，黑名单优先）
#   - 8.8.8.8        → 阻止（不在allowList中，默认拒绝）
#   - 10.0.0.5       → 阻止（在denyList中）
#
# 最佳实践：
# - 使用CIDR网段而非逐个列举IP地址
# - 定期审查和更新白名单
# - 使用denyList处理临时封禁
